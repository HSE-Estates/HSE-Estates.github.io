<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Healthcare Infrastructure QS</title>

  <!-- Tailwind -->
  <script src="https://cdn.tailwindcss.com"></script>

  <!-- React -->
  <script crossorigin src="https://unpkg.com/react@18/umd/react.development.js"></script>
  <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>

  <!-- Babel -->
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

  <!-- Lucide React (UMD) -->
  <script src="https://unpkg.com/lucide-react@latest/dist/umd/lucide-react.js"></script>
</head>

<body class="bg-slate-50">
  <div id="root"></div>

  <script type="text/babel">
    const { useState, useEffect } = React;

    const {
      Calculator, Building, Timer, Plus, Trash2, ToggleLeft, ToggleRight,
      Printer, Save, FileText, Euro, DoorOpen, Zap, Hammer, Leaf, Siren, MapPin
    } = lucideReact;

    // --- UI COMPONENTS ---
    const Card = ({ children, className = "" }) => (
      <div className={`bg-white rounded-xl shadow-sm border border-slate-200 ${className}`}>
        {children}
      </div>
    );

    const SectionHeader = ({ title, icon: Icon }) => (
      <div className="flex items-center gap-2 mb-4 pb-2 border-b border-slate-100 text-emerald-800">
        {Icon && <Icon className="w-5 h-5" />}
        <h3 className="font-bold text-slate-800 uppercase tracking-tight text-sm">{title}</h3>
      </div>
    );

    function App() {
      const [assetType, setAssetType] = useState('acute');
      const [intervention, setIntervention] = useState('new');
      const [gfa, setGfa] = useState(1000);
      const [region, setRegion] = useState('hse_sw');
      const [year, setYear] = useState('2026');
      const [complexity, setComplexity] = useState('med');
      const [duration, setDuration] = useState(18);
      const [includeVat, setIncludeVat] = useState(true);
      const [customDoorCount, setCustomDoorCount] = useState('');
      const [projectName, setProjectName] = useState('');
      const [isLiveSite, setIsLiveSite] = useState(false);
      const [customItems, setCustomItems] = useState([]);
      const [results, setResults] = useState(null);

      const [extras, setExtras] = useState({
        generator: false,
        berUpgrade: false,
        newRoof: false,
      });

      const baseRates = {
        acute: { new: { low: 6500, med: 8500, high: 10500 }, refurb: { low: 8000, med: 10500, high: 13000 } },
        cnu: { new: { low: 3500, med: 4000, high: 4500 }, refurb: { low: 4000, med: 4750, high: 5500 } },
        groupHome: { new: { low: 2800, med: 3150, high: 3500 }, refurb: { low: 2200, med: 2600, high: 3000 } }
      };

      const regionalIndices = {
        hse_dne: 1.10, hse_dm: 1.10, hse_dse: 1.10,
        hse_mw: 1.00, hse_sw: 1.00, hse_wnw: 0.98
      };

      const annualInflation = 0.035;
      const liveSitePremium = 0.15;

      useEffect(() => {
        const rawRate = baseRates[assetType][intervention][complexity];
        const inflationFactor = Math.pow(1 + annualInflation, duration / 24);
        const adjustedRate = rawRate * regionalIndices[region] * inflationFactor * (isLiveSite ? 1.15 : 1);
        const constructionCost = adjustedRate * gfa;

        setResults({
          adjustedRate,
          constructionCost,
          totalProjectCost: constructionCost * 1.35
        });
      }, [assetType, intervention, complexity, region, duration, gfa, isLiveSite]);

      const formatCurrency = (v) =>
        new Intl.NumberFormat('en-IE', { style: 'currency', currency: 'EUR', maximumFractionDigits: 0 }).format(v || 0);

      return (
        <div className="min-h-screen p-6">
          <header className="bg-emerald-900 text-white p-4 rounded-xl mb-6">
            <h1 className="text-2xl font-black">Healthcare Infrastructure QS</h1>
          </header>

          <div className="grid grid-cols-1 lg:grid-cols-2 gap-6">
            <Card className="p-6">
              <SectionHeader title="Project Parameters" icon={Calculator} />
              <label className="block text-xs font-bold mb-1">GFA (m²)</label>
              <input
                type="range"
                min="100"
                max="20000"
                step="50"
                value={gfa}
                onChange={(e) => setGfa(+e.target.value)}
                className="w-full"
              />
              <div className="mt-2 font-bold">{gfa} m²</div>
            </Card>

            <Card className="p-6">
              <SectionHeader title="Summary" icon={Euro} />
              <div className="text-3xl font-black text-emerald-700">
                {results && formatCurrency(results.totalProjectCost)}
              </div>
            </Card>
          </div>
        </div>
      );
    }

    const root = ReactDOM.createRoot(document.getElementById("root"));
    root.render(<App />);
  </script>
</body>
</html>
