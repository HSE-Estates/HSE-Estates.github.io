<!DOCTYPE html>
<html lang="en-GB">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Service Directory | HSE Capital & Estates</title>
    
    <!-- HSE Favicon -->
    <link rel="icon" href="https://assets.hse.ie/static/hse-frontend/assets/favicons/favicon.ico">
    
    <!-- Fonts: Inter for a clean, premium look -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&display=swap" rel="stylesheet">
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- React & Babel -->
    <script src="https://unpkg.com/react@18/umd/react.production.min.js" crossorigin></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js" crossorigin></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    
    <!-- Custom Styles -->
    <style>
        :root {
            --hse-primary: #006858;
            --hse-secondary: #00bfa5;
            --hse-dark: #004d42;
        }

        body { 
            font-family: 'Inter', system-ui, -apple-system, sans-serif; 
            background-color: #f8fafc;
            color: #1e293b;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
            overscroll-behavior-y: none;
        }

        /* Premium Scrollbar */
        .custom-scrollbar::-webkit-scrollbar {
            width: 4px;
            height: 6px; /* Added height for horizontal scroll */
        }
        .custom-scrollbar::-webkit-scrollbar-track {
            background: transparent;
        }
        .custom-scrollbar::-webkit-scrollbar-thumb {
            background-color: rgba(0, 104, 88, 0.2);
            border-radius: 10px;
        }
        .custom-scrollbar::-webkit-scrollbar-thumb:hover {
            background-color: rgba(0, 104, 88, 0.4);
        }
        
        /* Animations */
        .animate-fadeIn { animation: fadeIn 0.6s cubic-bezier(0.16, 1, 0.3, 1) forwards; opacity: 0; transform: translateY(10px); }
        @keyframes fadeIn { to { opacity: 1; transform: translateY(0); } }
        
        /* Glass blur utilities */
        .glass-header {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(12px);
            -webkit-backdrop-filter: blur(12px);
        }

        /* Mobile Slide Animation */
        .sidebar-transition {
            transition: transform 0.3s cubic-bezier(0.4, 0, 0.2, 1), width 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }

        /* PRINT STYLES */
        @media print {
            @page {
                size: landscape; 
                margin: 5mm;    
            }
            body {
                background: white;
                -webkit-print-color-adjust: exact !important;
                print-color-adjust: exact !important;
                width: 100%;
                overflow: visible !important;
            }
            /* Hide UI elements */
            aside, header button, .no-print {
                display: none !important;
            }
            /* Ensure main content takes full width */
            main {
                margin: 0 !important;
                padding: 0 !important;
                width: 100% !important;
                overflow: visible !important;
                position: static !important;
            }
            /* Root adjustments */
            #root {
                width: 100%;
                zoom: 55%; /* Scale down to fit wide organogram */
            }
            /* Organogram specifics */
            .connector-line, .connector-line-vertical {
                background-color: #9ca3af !important; 
                -webkit-print-color-adjust: exact !important;
            }
            .org-card {
                break-inside: avoid;
                box-shadow: none !important;
                border: 1px solid #ccc !important;
                border-top-width: 4px !important;
            }
            /* Force expansion */
            .accordion-content {
                display: block !important;
                height: auto !important;
                opacity: 1 !important;
            }
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useMemo, useEffect } = React;

        // --- ICONS ---
        const Icon = ({ size = 24, className = "", children, ...props }) => (
            <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className} {...props}>{children}</svg>
        );

        const Search = (props) => <Icon {...props}><circle cx="11" cy="11" r="8"/><path d="m21 21-4.3-4.3"/></Icon>;
        const Plus = (props) => <Icon {...props}><path d="M5 12h14"/><path d="M12 5v14"/></Icon>;
        const Trash2 = (props) => <Icon {...props}><path d="M3 6h18"/><path d="M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6"/><path d="M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2"/><line x1="10" x2="10" y1="11" y2="17"/><line x1="14" x2="14" y1="11" y2="17"/></Icon>;
        const Edit2 = (props) => <Icon {...props}><path d="M17 3a2.828 2.828 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5L17 3z"/></Icon>;
        const Phone = (props) => <Icon {...props}><path d="M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z"/></Icon>;
        const Mail = (props) => <Icon {...props}><rect width="20" height="16" x="2" y="4" rx="2"/><path d="m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7"/></Icon>;
        const User = (props) => <Icon {...props}><path d="M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2"/><circle cx="12" cy="7" r="4"/></Icon>;
        const MapPin = (props) => <Icon {...props}><path d="M20 10c0 6-8 12-8 12s-8-6-8-12a8 8 0 0 1 16 0Z"/><circle cx="12" cy="10" r="3"/></Icon>;
        const X = (props) => <Icon {...props}><path d="M18 6 6 18"/><path d="m6 6 12 12"/></Icon>;
        const Menu = (props) => <Icon {...props}><line x1="4" x2="20" y1="12" y2="12"/><line x1="4" x2="20" y1="6" y2="6"/><line x1="4" x2="20" y1="18" y2="18"/></Icon>;
        const ChevronRight = (props) => <Icon {...props}><path d="m9 18 6-6-6-6"/></Icon>;
        const ChevronDown = (props) => <Icon {...props}><path d="m6 9 6 6 6-6"/></Icon>;
        const ChevronUp = (props) => <Icon {...props}><path d="m18 15-6-6-6 6"/></Icon>;
        const Database = (props) => <Icon {...props}><ellipse cx="12" cy="5" rx="9" ry="3"/><path d="M21 12c0 1.66-4 3-9 3s-9-1.34-9-3"/><path d="M3 5v14c0 1.66 4 3 9 3s9-1.34 9-3V5"/></Icon>;
        const Building2 = (props) => <Icon {...props}><path d="M6 22V4a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v18Z"/><path d="M6 12H4a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2h2"/><path d="M18 9h2a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2h-2"/><path d="M10 6h4"/><path d="M10 10h4"/><path d="M10 14h4"/><path d="M10 18h4"/></Icon>;
        const LayoutGrid = (props) => <Icon {...props}><rect width="7" height="7" x="3" y="3" rx="1"/><rect width="7" height="7" x="14" y="3" rx="1"/><rect width="7" height="7" x="14" y="14" rx="1"/><rect width="7" height="7" x="3" y="14" rx="1"/></Icon>;
        const GitMerge = (props) => <Icon {...props}><circle cx="18" cy="18" r="3"/><circle cx="6" cy="6" r="3"/><path d="M6 21V9a9 9 0 0 0 9 9"/></Icon>;
        const Printer = (props) => <Icon {...props}><polyline points="6 9 6 2 18 2 18 9"/><path d="M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2"/><rect x="6" y="14" width="12" height="8"/></Icon>;

        // --- DATA ---
        const INITIAL_DATA = {
          "Advocacy, National & Regional Representative Groups": [
            { id: 101, name: "Citizens’ Information Centre", contact: "", email: "", address: "Cork/Kerry", person: "" },
            { id: 102, name: "Patient Advocacy Service", contact: "", email: "", address: "", person: "" },
            { id: 103, name: "Public Participation Network", contact: "", email: "", address: "", person: "" },
            { id: 104, name: "CORU", contact: "", email: "", address: "", person: "" },
            { id: 105, name: "Social and Health Education Project (SHEP) Cork", contact: "", email: "", address: "Cork", person: "" },
            { id: 106, name: "National Patient Forum", contact: "", email: "", address: "", person: "" },
            { id: 107, name: "The Wheel", contact: "", email: "", address: "", person: "" },
            { id: 108, name: "Patients for Patient Safety Ireland (PFPSI)", contact: "", email: "", address: "", person: "" },
            { id: 109, name: "As-I-Am", contact: "", email: "", address: "", person: "" },
            { id: 110, name: "Autism Ireland", contact: "", email: "", address: "", person: "" },
            { id: 111, name: "Irish Pharmacy Unit", contact: "", email: "", address: "", person: "" },
            { id: 112, name: "All-Ireland Institute of Hospice and Palliative Care", contact: "", email: "", address: "", person: "" },
            { id: 113, name: "Diabetes Ireland", contact: "", email: "", address: "", person: "" },
            { id: 114, name: "Asthma Ireland", contact: "", email: "", address: "", person: "" },
            { id: 115, name: "Irish Kidney Association", contact: "", email: "", address: "", person: "" },
            { id: 116, name: "Feileacain", contact: "", email: "", address: "", person: "" },
            { id: 117, name: "Irish Cancer Society", contact: "", email: "", address: "", person: "" },
            { id: 118, name: "Recovery Haven Kerry", contact: "", email: "", address: "Kerry", person: "" },
            { id: 119, name: "Cork ARC Cancer Support House", contact: "", email: "", address: "Cork", person: "" }
          ],
          "Older Adults": [
            { id: 201, name: "Active Retirement Group", contact: "", email: "", address: "", person: "" },
            { id: 202, name: "Age Action Ireland", contact: "", email: "", address: "", person: "" },
            { id: 203, name: "Older Persons Councils", contact: "", email: "", address: "", person: "" },
            { id: 204, name: "ALONE", contact: "", email: "", address: "", person: "" },
            { id: 205, name: "Alzheimers Society of Ireland", contact: "", email: "", address: "", person: "" },
            { id: 206, name: "Integrated Care Programme for Older Persons (ICPOP)", contact: "", email: "", address: "", person: "" },
            { id: 207, name: "Older Peoples Committee", contact: "", email: "", address: "", person: "" },
            { id: 208, name: "Older Peoples Forum", contact: "", email: "", address: "", person: "" },
            { id: 209, name: "Patient Advocacy Service", contact: "", email: "", address: "", person: "" },
            { id: 210, name: "Elder Abuse Services", contact: "", email: "", address: "", person: "" },
            { id: 211, name: "Meals on Wheels Services", contact: "", email: "", address: "", person: "" },
            { id: 212, name: "Mens Sheds", contact: "", email: "", address: "", person: "" }
          ],
          "Disability Organisations": [
            { id: 301, name: "Children’s Disability Network Teams (CDNTs) Family Representatives", contact: "", email: "", address: "", person: "" },
            { id: 302, name: "Independent Living Movement Ireland", contact: "", email: "", address: "", person: "" },
            { id: 303, name: "National Federation of Voluntary Service providers", contact: "", email: "", address: "", person: "" },
            { id: 304, name: "St John of Gods", contact: "", email: "", address: "", person: "" },
            { id: 505, name: "REHAB", contact: "", email: "", address: "", person: "" },
            { id: 506, name: "Co-Action", contact: "", email: "", address: "", person: "" },
            { id: 307, name: "MS Ireland", contact: "", email: "", address: "", person: "" },
            { id: 308, name: "National Advocacy Service", contact: "", email: "", address: "", person: "" },
            { id: 309, name: "Invisible Disabilities Groups", contact: "", email: "", address: "", person: "" },
            { id: 310, name: "COPE Foundation", contact: "", email: "", address: "", person: "" },
            { id: 311, name: "Brothers of Charity", contact: "", email: "", address: "", person: "" },
            { id: 312, name: "Disability Federation of Ireland", contact: "", email: "", address: "", person: "" },
            { id: 313, name: "National Disability Authority", contact: "", email: "", address: "", person: "" },
            { id: 314, name: "Enable Ireland", contact: "", email: "", address: "", person: "" },
            { id: 315, name: "Kerry Deaf Society", contact: "", email: "", address: "Kerry", person: "" },
            { id: 316, name: "Cork Deaf Association", contact: "", email: "", address: "Cork", person: "" }
          ],
          "Children & Young People": [
            { id: 401, name: "Jigsaw (Children & Young People)", contact: "", email: "", address: "", person: "" },
            { id: 402, name: "Youth Council of Ireland", contact: "", email: "", address: "", person: "" },
            { id: 403, name: "Childline", contact: "", email: "", address: "", person: "" },
            { id: 404, name: "TUSLA", contact: "", email: "", address: "", person: "" },
            { id: 405, name: "Childrens Disability Network Teams (CDNTs)", contact: "", email: "", address: "", person: "" },
            { id: 406, name: "Rainbow Club Cork", contact: "", email: "", address: "Cork", person: "" },
            { id: 407, name: "Shine Centre for Autism", contact: "", email: "", address: "", person: "" },
            { id: 408, name: "Children and Young People's Services Committees (CYPSC)", contact: "", email: "", address: "", person: "" },
            { id: 409, name: "Kerry Community Youth Service", contact: "", email: "", address: "Kerry", person: "" },
            { id: 410, name: "Kerry Adolescent Counselling Service", contact: "", email: "", address: "Kerry", person: "" },
            { id: 411, name: "CAMHS", contact: "", email: "", address: "", person: "" },
            { id: 412, name: "St John of Gods", contact: "", email: "", address: "", person: "" },
            { id: 413, name: "Kerry Intervention & Disability Services (KIDS)", contact: "", email: "", address: "Kerry", person: "" }
          ],
          "Homelessness, Housing & Emergency Accommodation": [
             { id: 501, name: "NOVAS", contact: "", email: "", address: "", person: "" },
             { id: 502, name: "Simon Community (Cork, Kerry)", contact: "", email: "", address: "Cork/Kerry", person: "" },
             { id: 507, name: "FOCUS Ireland", contact: "", email: "", address: "", person: "" },
             { id: 508, name: "DePaul Ireland", contact: "", email: "", address: "", person: "" },
             { id: 509, name: "Good Shepherd", contact: "", email: "", address: "", person: "" },
             { id: 510, name: "CLUID", contact: "", email: "", address: "", person: "" },
             { id: 511, name: "RESPOND", contact: "", email: "", address: "", person: "" }
          ],
          "Migrant, Refugee & Asylum‑Seeker Supports": [
            { id: 503, name: "NASC Migrant & Refugee Rights", contact: "", email: "", address: "", person: "" },
            { id: 512, name: "Tralee International Resource Centre", contact: "", email: "", address: "Tralee", person: "" },
            { id: 513, name: "Killarney Immigrant Support Centre", contact: "", email: "", address: "Killarney", person: "" },
            { id: 504, name: "Sanctuary Runners", contact: "", email: "", address: "", person: "" }
          ],
          "Traveller Community Organisations": [
            { id: 514, name: "Kerry Traveller Health & Community Development Project", contact: "", email: "", address: "Kerry", person: "" },
            { id: 515, name: "West Cork Travellers", contact: "", email: "", address: "West Cork", person: "" },
            { id: 516, name: "East Cork Travellers (Centres)", contact: "", email: "", address: "East Cork", person: "" },
            { id: 517, name: "Travellers of North Cork (TNC)", contact: "", email: "", address: "North Cork", person: "" },
            { id: 518, name: "Cork Traveller Women’s Network", contact: "", email: "", address: "Cork", person: "" },
            { id: 519, name: "Kerry Travellers", contact: "", email: "", address: "Kerry", person: "" },
            { id: 520, name: "Traveller Visibility Group (TVG)", contact: "", email: "", address: "", person: "" },
            { id: 521, name: "Traveller Pavee Point", contact: "", email: "", address: "", person: "" }
          ],
          "LGBTQI+ Supports": [
             { id: 526, name: "LINQ (LGBTQI+)", contact: "", email: "", address: "", person: "" },
             { id: 530, name: "SCEEN Kerry LGBTQI Group", contact: "", email: "", address: "Kerry", person: "" },
             { id: 527, name: "Trans Kerry Support Group & SCEEN in Kerry", contact: "", email: "", address: "Kerry", person: "" },
             { id: 531, name: "Gay Project", contact: "", email: "", address: "", person: "" },
             { id: 532, name: "Gender Rebels", contact: "", email: "", address: "", person: "" }
          ],
          "Addiction, Recovery & Substance Use Support": [
            { id: 522, name: "Coolmine (Drugs & Alcohol)", contact: "", email: "", address: "", person: "" },
            { id: 523, name: "Drugs Task Force", contact: "", email: "", address: "", person: "" }
          ],
          "Mental Health Organisations and Supports": [
            { id: 601, name: "PIETA", contact: "", email: "", address: "", person: "" },
            { id: 602, name: "Peer Advocacy", contact: "", email: "", address: "", person: "" },
            { id: 603, name: "Aware", contact: "", email: "", address: "", person: "" },
            { id: 604, name: "Youth Suicide Prevention Ireland", contact: "", email: "", address: "", person: "" },
            { id: 605, name: "GROW", contact: "", email: "", address: "", person: "" },
            { id: 606, name: "Jigsaw (South West Counselling)", contact: "", email: "", address: "", person: "" },
            { id: 607, name: "HSE South West Mental Health Partnership Group", contact: "", email: "", address: "", person: "" },
            { id: 608, name: "Kerry Mental Health Association", contact: "", email: "", address: "Kerry", person: "" },
            { id: 609, name: "Samaritans", contact: "", email: "", address: "", person: "" }
          ],
          "Community, Family & Domestic Violence Supports": [
            { id: 524, name: "Comhar na nOilean", contact: "", email: "", address: "", person: "" },
            { id: 525, name: "West Cork Islands Community", contact: "", email: "", address: "West Cork", person: "" },
            { id: 528, name: "Listowel Child & Family Resource Centre", contact: "", email: "", address: "Listowel", person: "" },
            { id: 529, name: "Mens / Womens / Queer Sheds / AA / NA / GA", contact: "", email: "", address: "", person: "" },
            { id: 533, name: "Penny Dinners", contact: "", email: "", address: "", person: "" },
            { id: 534, name: "NICHE Health Project", contact: "", email: "", address: "", person: "" },
            { id: 535, name: "Family Resource Centres", contact: "", email: "", address: "", person: "" },
            { id: 536, name: "One Stop Shop (OSS), Domestic Abuse", contact: "", email: "", address: "", person: "" },
            { id: 537, name: "Rape Crisis Centre", contact: "", email: "", address: "", person: "" },
            { id: 538, name: "West Cork Women against Violence", contact: "", email: "", address: "West Cork", person: "" },
            { id: 539, name: "RUHAMA", contact: "", email: "", address: "", person: "" },
            { id: 540, name: "Sexual Health Clinic", contact: "", email: "", address: "", person: "" },
            { id: 541, name: "ADAPT Kerry", contact: "", email: "", address: "Kerry", person: "" },
            { id: 542, name: "ADAPT (Kerry Women's Refuge)", contact: "", email: "", address: "Kerry", person: "" },
            { id: 543, name: "Kerry Rape and Sexual Abuse Centre", contact: "", email: "", address: "Kerry", person: "" },
            { id: 544, name: "Sage Lions club", contact: "", email: "", address: "", person: "" }
          ]
        };

        const CATEGORIES = Object.keys(INITIAL_DATA);
        const COLORS = ["border-blue-500", "border-emerald-500", "border-purple-500", "border-orange-500", "border-rose-500", "border-cyan-500", "border-indigo-500", "border-teal-500"];

        // --- ORGANOGRAM COMPONENT ---
        const OrgNode = ({ title, items, color, isRoot = false }) => {
            const [isExpanded, setIsExpanded] = useState(true);

            if (isRoot) {
                return (
                    <div className="flex flex-col items-center relative z-20 break-inside-avoid">
                        <div className="bg-white rounded-xl shadow-xl border border-gray-100 p-6 md:p-8 text-center w-[300px] md:w-[480px] relative overflow-hidden group transition-all duration-300 hover:shadow-2xl">
                            <div className="absolute top-0 left-0 right-0 h-2 bg-[#006858]"></div>
                            <div className="mb-4 md:mb-6 flex justify-center">
                                <img 
                                    src="https://www.esther.ie/wp-content/uploads/2022/05/HSE-Logo-Green-NEW-no-background.png" 
                                    alt="HSE South West" 
                                    className="h-16 md:h-20 object-contain"
                                />
                            </div>
                            <h1 className="text-xl md:text-2xl font-bold text-gray-800 uppercase tracking-tight mb-2 leading-tight">HSE South West</h1>
                            <p className="text-[#006858] font-medium text-xs md:text-sm tracking-wide uppercase opacity-90">Representative Groups for Patients & Service-Users</p>
                        </div>
                    </div>
                );
            }

            return (
                <div className={`org-card w-full bg-white rounded-lg shadow-md hover:shadow-xl transition-all duration-300 flex flex-col border-t-4 ${color} overflow-hidden h-full`}>
                    <div 
                        className="p-3 md:p-4 cursor-pointer flex justify-between items-start gap-3 bg-white hover:bg-gray-50 transition-colors"
                        onClick={() => setIsExpanded(!isExpanded)}
                    >
                        <div className="flex-1">
                            <h3 className="font-bold text-gray-800 text-sm md:text-[15px] leading-snug">{title}</h3>
                            <span className="mt-2 inline-flex items-center px-2.5 py-0.5 rounded-full text-[10px] md:text-xs font-medium bg-gray-100 text-gray-600 border border-gray-200">
                                {items.length} Groups
                            </span>
                        </div>
                        <button className="text-gray-400 hover:text-[#006858] transition-colors mt-1 no-print">
                            {isExpanded ? <ChevronUp size={16} /> : <ChevronDown size={16} />}
                        </button>
                    </div>
                    
                    {isExpanded && (
                        <div className="accordion-content px-3 md:px-4 pb-4 space-y-2 bg-gray-50/50 border-t border-gray-100 flex-grow">
                            <div className="pt-2 space-y-2">
                                {items.map((item, idx) => (
                                    <div key={idx} className="bg-white px-2 py-2 md:px-3 md:py-2.5 rounded border border-gray-200 text-xs md:text-[13px] text-gray-700 shadow-sm hover:border-[#006858] hover:text-gray-900 transition-all leading-snug break-words">
                                        {item}
                                    </div>
                                ))}
                            </div>
                        </div>
                    )}
                </div>
            );
        };

        const OrganogramView = ({ data }) => {
            // Transform data for organogram: extract names only
            const transformedData = useMemo(() => {
                return Object.keys(data).map(key => ({
                    title: key,
                    items: data[key].map(d => d.name)
                }));
            }, [data]);

            return (
                <div className="p-4 md:p-8 overflow-x-auto custom-scrollbar bg-slate-100/50 min-h-screen">
                    <div className="min-w-[1400px] mx-auto flex flex-col items-center pb-20">
                        
                        {/* Root Node */}
                        <OrgNode isRoot={true} />
                        
                        {/* Vertical Connector from Root */}
                        <div className="h-10 w-0.5 bg-gray-300 connector-line-vertical"></div>

                        {/* Main Grid Wrapper */}
                        <div className="w-full flex justify-center items-start">
                            {transformedData.map((category, index) => {
                                const isFirst = index === 0;
                                const isLast = index === transformedData.length - 1;
                                
                                return (
                                    <div key={index} className="flex-1 min-w-[280px] flex flex-col items-center relative">
                                        
                                        {/* Top Lines Container */}
                                        <div className="w-full h-10 relative">
                                            {/* Horizontal Line Logic */}
                                            {!isFirst && (
                                                <div className="absolute top-0 left-0 w-1/2 h-0.5 bg-gray-300 connector-line"></div>
                                            )}
                                            {!isLast && (
                                                <div className="absolute top-0 right-0 w-1/2 h-0.5 bg-gray-300 connector-line"></div>
                                            )}
                                            {/* Vertical Down Line */}
                                            <div className="absolute top-0 left-1/2 -translate-x-1/2 h-full w-0.5 bg-gray-300 connector-line-vertical"></div>
                                        </div>

                                        {/* Card Wrapper with padding to simulate gap */}
                                        <div className="w-full pt-0 pb-4 px-2"> 
                                            <OrgNode 
                                                title={category.title} 
                                                items={category.items}
                                                color={COLORS[index % COLORS.length]}
                                            />
                                        </div>
                                    </div>
                                );
                            })}
                        </div>
                         <div className="text-center py-10 print:hidden">
                            <p className="text-gray-400 text-xs uppercase tracking-widest font-medium">HSE South West Cork & Kerry • Strategic Planning</p>
                        </div>
                    </div>
                </div>
            );
        };

        function App() {
          // State
          const [data, setData] = useState(INITIAL_DATA);
          const [selectedCategory, setSelectedCategory] = useState(CATEGORIES[0]);
          const [searchQuery, setSearchQuery] = useState("");
          const [viewMode, setViewMode] = useState("list"); // 'list' or 'organogram'
          
          // Responsive Sidebar State
          const [sidebarOpen, setSidebarOpen] = useState(window.innerWidth > 768);
          const [isMobile, setIsMobile] = useState(window.innerWidth <= 768);

          useEffect(() => {
            const handleResize = () => {
              const mobile = window.innerWidth <= 768;
              setIsMobile(mobile);
              if (!mobile) setSidebarOpen(true); 
              if (mobile && sidebarOpen) setSidebarOpen(false); 
            };
            window.addEventListener('resize', handleResize);
            return () => window.removeEventListener('resize', handleResize);
          }, []);
          
          // Edit/Add State
          const [editingId, setEditingId] = useState(null);
          const [isAddingNew, setIsAddingNew] = useState(false);
          const [tempFormData, setTempFormData] = useState({});

          // -- Filtering Logic --
          const filteredData = useMemo(() => {
            let list = [];
            if (searchQuery.trim() !== "") {
              Object.keys(data).forEach(cat => {
                const matches = data[cat].filter(item => 
                  item.name.toLowerCase().includes(searchQuery.toLowerCase()) ||
                  item.address.toLowerCase().includes(searchQuery.toLowerCase())
                );
                matches.forEach(m => list.push({ ...m, category: cat }));
              });
            } else {
              list = data[selectedCategory].map(item => ({...item, category: selectedCategory}));
            }
            return list;
          }, [data, selectedCategory, searchQuery]);

          // -- Handlers --
          const handleEditClick = (item) => {
            setEditingId(item.id);
            setTempFormData(item);
            setIsAddingNew(false);
          };

          const handleDeleteClick = (category, id) => {
            if (window.confirm("Are you sure you want to remove this organisation?")) {
              setData(prev => ({
                ...prev,
                [category]: prev[category].filter(item => item.id !== id)
              }));
            }
          };

          const handleSave = () => {
            if (isAddingNew) {
              const newId = Date.now();
              const newItem = { ...tempFormData, id: newId };
              const categoryToAddTo = tempFormData.category || selectedCategory;
              setData(prev => ({
                ...prev,
                [categoryToAddTo]: [...(prev[categoryToAddTo] || []), newItem]
              }));
            } else {
              const categoryToUpdate = tempFormData.category; 
              setData(prev => ({
                ...prev,
                [categoryToUpdate]: prev[categoryToUpdate].map(item => 
                  item.id === editingId ? tempFormData : item
                )
              }));
            }
            setEditingId(null);
            setIsAddingNew(false);
            setTempFormData({});
          };

          const handleAddNewClick = () => {
            setIsAddingNew(true);
            setEditingId("NEW");
            setTempFormData({
              name: "",
              contact: "",
              email: "",
              address: "",
              person: "",
              category: selectedCategory
            });
          };

          const handleInputChange = (field, value) => {
            setTempFormData(prev => ({ ...prev, [field]: value }));
          };

          const handleCategorySelect = (cat) => {
             setSelectedCategory(cat);
             setSearchQuery("");
             if (isMobile) setSidebarOpen(false); 
          };

          // Handle Print from Organogram View
          const handlePrint = () => {
             window.print();
          };

          return (
            <div className="flex h-screen bg-slate-50 text-slate-800 font-sans overflow-hidden selection:bg-emerald-100 selection:text-emerald-900 relative">
              
              {/* --- Mobile Sidebar Overlay (Only in List Mode) --- */}
              {isMobile && sidebarOpen && viewMode === 'list' && (
                <div 
                    className="fixed inset-0 bg-slate-900/60 backdrop-blur-sm z-30 transition-opacity animate-fadeIn no-print"
                    onClick={() => setSidebarOpen(false)}
                ></div>
              )}

              {/* --- Sidebar (Hidden in Organogram Mode) --- */}
              {viewMode === 'list' && (
                  <aside 
                    className={`
                      sidebar-transition z-40 flex flex-col shadow-2xl no-print
                      ${isMobile ? 'fixed inset-y-0 left-0 h-full w-72' : 'relative h-full'}
                      ${sidebarOpen ? 'translate-x-0' : '-translate-x-full md:translate-x-0 md:w-20'}
                      ${!isMobile && sidebarOpen ? 'w-80' : ''}
                    `}
                    style={{
                      background: 'linear-gradient(145deg, #006858 0%, #004d42 100%)',
                      color: 'white'
                    }}
                  >
                    <div className="p-6 flex flex-col items-start space-y-4 border-b border-white/10 relative">
                      <div className="flex items-center justify-between w-full">
                        {/* Logo Area */}
                        {(sidebarOpen || isMobile) ? (
                            <div className="bg-white p-2 md:p-3 rounded-xl shadow-lg transform transition hover:scale-105 duration-300">
                              <img src="https://www.esther.ie/wp-content/uploads/2022/05/HSE-Logo-Green-NEW-no-background.png" alt="HSE" className="h-8 md:h-9 object-contain"/>
                            </div>
                        ) : (
                            <div className="bg-white p-1.5 rounded-lg mx-auto">
                              <img src="https://www.esther.ie/wp-content/uploads/2022/05/HSE-Logo-Green-NEW-no-background.png" alt="HSE" className="h-5 object-contain"/>
                            </div>
                        )}
                        
                        {/* Toggle Button */}
                        <button 
                            onClick={() => setSidebarOpen(!sidebarOpen)} 
                            className={`p-1.5 hover:bg-white/10 rounded-full text-emerald-100 transition-colors ${isMobile ? 'absolute right-4 top-6' : ''}`}
                        >
                          {(sidebarOpen || isMobile) ? <X size={20} /> : <Menu size={20} />}
                        </button>
                      </div>
                      
                      {/* Title Area */}
                      {(sidebarOpen || isMobile) && (
                        <div className="animate-fadeIn pt-1">
                          <h1 className="font-extrabold text-lg md:text-xl tracking-tight leading-none text-white drop-shadow-sm">
                            Service Directory
                          </h1>
                          <p className="text-[10px] text-emerald-200 font-bold uppercase tracking-[0.15em] mt-1.5 opacity-90">
                            Patient Engagement
                          </p>
                        </div>
                      )}
                    </div>

                    {/* Nav Links */}
                    <div className="flex-1 overflow-y-auto py-6 px-3 space-y-2 custom-scrollbar">
                      {CATEGORIES.map(cat => (
                        <button
                          key={cat}
                          onClick={() => handleCategorySelect(cat)}
                          className={`w-full text-left px-4 py-3.5 rounded-xl flex items-center justify-between transition-all duration-300 group relative overflow-hidden ${
                            selectedCategory === cat && !searchQuery
                              ? "bg-white text-[#006858] shadow-[0_4px_12px_rgba(0,0,0,0.15)] font-bold translate-x-1"
                              : "text-emerald-50 hover:bg-white/10 hover:text-white"
                          }`}
                        >
                          <div className="flex items-center space-x-3 overflow-hidden z-10">
                            <div className={`w-1.5 h-1.5 rounded-full transition-all duration-300 ${selectedCategory === cat && !searchQuery ? 'bg-[#00bfa5] scale-125' : 'bg-white/30'}`}></div>
                            <span className={`truncate text-sm tracking-wide ${(sidebarOpen || isMobile) ? '' : 'hidden'}`}>{cat}</span>
                          </div>
                          {selectedCategory === cat && !searchQuery && <ChevronRight size={16} className={(sidebarOpen || isMobile) ? 'text-[#00bfa5]' : 'hidden'} />}
                        </button>
                      ))}
                    </div>
                    
                    {(sidebarOpen || isMobile) && (
                        <div className="p-5 bg-[#004d42]/60 backdrop-blur-sm border-t border-white/5 text-[10px] text-emerald-200/70 text-center">
                          <p className="font-medium">Secure Environment</p>
                          <p className="mt-0.5">Capital & Estates System</p>
                        </div>
                    )}
                  </aside>
              )}

              {/* --- Main Content --- */}
              <main className={`flex-1 flex flex-col h-full overflow-hidden relative bg-slate-50/80 w-full ${viewMode === 'organogram' ? 'bg-white' : ''}`}>
                
                {/* Header */}
                <header className="sticky top-0 z-20 glass-header border-b border-slate-200/60 px-4 md:px-8 py-4 md:py-5 flex flex-col md:flex-row md:items-center justify-between gap-4 transition-all duration-500">
                  <div className="flex items-center gap-3">
                    {/* Mobile Menu Button (List Mode Only) */}
                    {viewMode === 'list' && (
                        <button 
                            onClick={() => setSidebarOpen(true)} 
                            className="md:hidden p-2 -ml-2 text-slate-600 hover:bg-slate-100 rounded-full no-print"
                        >
                            <Menu size={24} />
                        </button>
                    )}

                    <div>
                        <div className="flex items-center space-x-2 text-slate-400 text-[10px] font-bold uppercase tracking-[0.15em] mb-1">
                           <Building2 size={12} className="text-[#006858]" />
                           <span>Cork & Kerry Region</span>
                        </div>
                        <h2 className="text-xl md:text-3xl font-black text-slate-800 tracking-tight drop-shadow-sm truncate max-w-[200px] md:max-w-none">
                          {viewMode === 'organogram' ? 'Organisational Chart' : (searchQuery ? <span className="text-slate-500">Search Results</span> : selectedCategory)}
                        </h2>
                    </div>
                  </div>

                  <div className="flex items-center gap-3 w-full md:w-auto no-print">
                    
                    {/* View Switcher */}
                    <div className="flex bg-slate-100 p-1 rounded-lg border border-slate-200/60">
                         <button 
                            onClick={() => setViewMode('list')}
                            className={`p-2 rounded-md transition-all flex items-center gap-2 text-xs font-bold ${viewMode === 'list' ? 'bg-white text-[#006858] shadow-sm' : 'text-slate-500 hover:text-slate-700'}`}
                         >
                            <LayoutGrid size={16} />
                            <span className="hidden md:inline">List</span>
                         </button>
                         <button 
                            onClick={() => setViewMode('organogram')}
                            className={`p-2 rounded-md transition-all flex items-center gap-2 text-xs font-bold ${viewMode === 'organogram' ? 'bg-white text-[#006858] shadow-sm' : 'text-slate-500 hover:text-slate-700'}`}
                         >
                            <GitMerge size={16} className="rotate-90" />
                            <span className="hidden md:inline">Chart</span>
                         </button>
                    </div>

                    {viewMode === 'list' ? (
                        <>
                            <div className="relative group flex-1 md:flex-none">
                              <Search className="absolute left-4 top-1/2 -translate-y-1/2 text-slate-400 w-4 h-4 group-focus-within:text-[#006858] transition-colors duration-300" />
                              <input 
                                type="text" 
                                placeholder="Find organisation..." 
                                className="pl-10 pr-10 py-2.5 w-full md:w-64 lg:w-80 bg-slate-100/80 hover:bg-white border border-transparent rounded-full focus:border-[#006858]/30 focus:bg-white focus:ring-4 focus:ring-[#006858]/10 transition-all duration-300 outline-none text-sm font-medium placeholder:text-slate-400 shadow-inner"
                                value={searchQuery}
                                onChange={(e) => setSearchQuery(e.target.value)}
                              />
                              {searchQuery && (
                                <button 
                                  onClick={() => setSearchQuery("")}
                                  className="absolute right-3 top-1/2 -translate-y-1/2 text-slate-400 hover:text-slate-600 bg-slate-200/50 hover:bg-slate-200 rounded-full p-0.5 transition-all"
                                >
                                  <X size={14} />
                                </button>
                              )}
                            </div>
                            <button 
                              onClick={handleAddNewClick}
                              className="bg-[#006858] hover:bg-[#005044] text-white p-2.5 md:px-6 md:py-3 rounded-full flex items-center justify-center space-x-2 shadow-lg shadow-[#006858]/20 hover:shadow-[#006858]/40 transition-all duration-300 active:scale-95"
                            >
                              <Plus size={20} strokeWidth={3} />
                              <span className="hidden md:inline font-bold tracking-wide text-sm">Add New</span>
                            </button>
                        </>
                    ) : (
                        <button 
                          onClick={handlePrint}
                          className="bg-slate-800 hover:bg-slate-700 text-white p-2.5 md:px-6 md:py-3 rounded-full flex items-center justify-center space-x-2 shadow-lg transition-all duration-300 active:scale-95"
                        >
                          <Printer size={20} />
                          <span className="hidden md:inline font-bold tracking-wide text-sm">Print Chart</span>
                        </button>
                    )}
                  </div>
                </header>

                {/* Content Area Switcher */}
                {viewMode === 'list' ? (
                     <div className="flex-1 overflow-y-auto scroll-smooth">
                      <div className="p-4 md:p-8 min-h-[calc(100vh-200px)]">
                        {filteredData.length === 0 ? (
                          <div className="h-64 md:h-96 flex flex-col items-center justify-center text-slate-400 animate-fadeIn">
                            <div className="bg-white p-6 md:p-8 rounded-full mb-4 md:mb-6 shadow-sm border border-slate-100">
                               <Search size={32} className="md:w-12 md:h-12 opacity-20 text-slate-500" />
                            </div>
                            <p className="font-bold text-base md:text-lg text-slate-600">No results found.</p>
                          </div>
                        ) : (
                          <div className="grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-4 md:gap-8 pb-12">
                            {filteredData.map((item, index) => (
                              <div 
                                key={item.id} 
                                className={`relative group bg-white rounded-2xl p-5 md:p-7 border border-black/5 shadow-sm transition-all duration-300 hover:-translate-y-1 hover:shadow-lg flex flex-col justify-between ${editingId === item.id ? 'ring-2 ring-[#006858] ring-offset-2' : ''}`}
                                style={{ animationDelay: `${index * 50}ms` }}
                              >
                                {/* Card Content */}
                                {editingId !== item.id ? (
                                  <>
                                    <div>
                                      <div className="flex justify-between items-start mb-4">
                                        <div className="w-8 h-8 md:w-10 md:h-10 bg-emerald-50 rounded-xl text-[#006858] flex items-center justify-center shadow-inner">
                                          <Database size={16} className="md:w-[18px] md:h-[18px]" />
                                        </div>
                                        <div className="flex space-x-1">
                                          <button 
                                            onClick={() => handleEditClick(item)}
                                            className="p-2 text-slate-400 hover:text-[#006858] hover:bg-emerald-50 rounded-lg transition-colors"
                                          >
                                            <Edit2 size={16} />
                                          </button>
                                          <button 
                                            onClick={() => handleDeleteClick(item.category, item.id)}
                                            className="p-2 text-slate-400 hover:text-red-600 hover:bg-red-50 rounded-lg transition-colors"
                                          >
                                            <Trash2 size={16} />
                                          </button>
                                        </div>
                                      </div>

                                      <h3 className="font-bold text-base md:text-lg text-slate-900 mb-2 leading-tight min-h-[3rem]">
                                        {item.name}
                                      </h3>
                                      
                                      {searchQuery && (
                                        <span className="inline-flex items-center px-2 py-0.5 rounded-md text-[10px] font-bold uppercase tracking-wider bg-slate-100 text-slate-600 mb-4">
                                          {item.category}
                                        </span>
                                      )}

                                      <div className="space-y-2.5 md:space-y-3 mt-2">
                                        <div className="flex items-center text-sm group/row">
                                          <div className="w-6 md:w-8 flex justify-center mr-1">
                                            <Phone size={14} className="text-emerald-500/70" />
                                          </div>
                                          <span className={`font-medium truncate ${!item.contact ? "text-slate-300 italic font-normal" : "text-slate-600"}`}>
                                            {item.contact || "No contact"}
                                          </span>
                                        </div>
                                        <div className="flex items-center text-sm group/row">
                                          <div className="w-6 md:w-8 flex justify-center mr-1">
                                            <Mail size={14} className="text-emerald-500/70" />
                                          </div>
                                          <span className={`font-medium truncate ${!item.email ? "text-slate-300 italic font-normal" : "text-slate-600"}`}>
                                            {item.email || "No email"}
                                          </span>
                                        </div>
                                        <div className="flex items-center text-sm group/row">
                                          <div className="w-6 md:w-8 flex justify-center mr-1">
                                            <User size={14} className="text-emerald-500/70" />
                                          </div>
                                          <span className={`font-medium truncate ${!item.person ? "text-slate-300 italic font-normal" : "text-slate-600"}`}>
                                            {item.person || "No person"}
                                          </span>
                                        </div>
                                         <div className="flex items-center text-sm group/row">
                                          <div className="w-6 md:w-8 flex justify-center mr-1">
                                            <MapPin size={14} className="text-emerald-500/70" />
                                          </div>
                                          <span className={`font-medium truncate ${!item.address ? "text-slate-300 italic font-normal" : "text-slate-600"}`}>
                                            {item.address || "No address"}
                                          </span>
                                        </div>
                                      </div>
                                    </div>
                                  </>
                                ) : (
                                  // Edit Mode
                                  <div className="space-y-3 md:space-y-4">
                                    <div>
                                      <label className="text-[10px] font-bold text-[#006858] uppercase tracking-widest mb-1 block">Name</label>
                                      <input 
                                        autoFocus
                                        type="text" 
                                        value={tempFormData.name} 
                                        onChange={(e) => handleInputChange('name', e.target.value)}
                                        className="w-full p-2 bg-slate-50 border border-slate-200 rounded-lg text-sm focus:border-[#006858] outline-none"
                                      />
                                    </div>
                                    <div className="grid grid-cols-2 gap-2">
                                       <div>
                                        <label className="text-[10px] font-bold text-slate-400 uppercase tracking-widest mb-1 block">Phone</label>
                                        <input 
                                          type="text" 
                                          value={tempFormData.contact} 
                                          onChange={(e) => handleInputChange('contact', e.target.value)}
                                          className="w-full p-2 bg-slate-50 border border-slate-200 rounded-lg text-sm outline-none"
                                        />
                                      </div>
                                      <div>
                                        <label className="text-[10px] font-bold text-slate-400 uppercase tracking-widest mb-1 block">Loc</label>
                                        <input 
                                          type="text" 
                                          value={tempFormData.address} 
                                          onChange={(e) => handleInputChange('address', e.target.value)}
                                          className="w-full p-2 bg-slate-50 border border-slate-200 rounded-lg text-sm outline-none"
                                        />
                                      </div>
                                    </div>
                                    <div className="flex gap-2 mt-2">
                                      <button onClick={handleSave} className="flex-1 bg-[#006858] text-white py-2 rounded-lg text-xs font-bold">Save</button>
                                      <button onClick={() => { setEditingId(null); if(isAddingNew) setIsAddingNew(false); }} className="flex-1 bg-slate-100 text-slate-600 py-2 rounded-lg text-xs font-bold">Cancel</button>
                                    </div>
                                  </div>
                                )}
                              </div>
                            ))}
                          </div>
                        )}
                      </div>

                      {/* Footer */}
                      <footer className="mt-auto border-t border-slate-200 bg-white/80 backdrop-blur-md py-8 md:py-12 px-4 md:px-8">
                          <div className="max-w-7xl mx-auto flex flex-col md:flex-row justify-between items-center gap-6 md:gap-8">
                              <div className="text-center md:text-left">
                                  <div className="flex items-center justify-center md:justify-start gap-3 mb-2">
                                      <div className="w-auto h-8 md:h-10 bg-[#006858] px-2 rounded-xl flex items-center justify-center shadow-lg">
                                        <img src="https://www.esther.ie/wp-content/uploads/2022/05/HSE-Logo-Green-NEW-no-background.png" className="h-5 md:h-6 object-contain brightness-0 invert" alt=""/>
                                      </div>
                                      <div>
                                        <span className="block font-black text-slate-800 text-base md:text-lg tracking-tight leading-none">HSE Capital & Estates</span>
                                      </div>
                                  </div>
                                  <p className="text-xs text-slate-400 font-medium">&copy; 2026 Health Service Executive.</p>
                              </div>
                              <div className="text-center md:text-right">
                                  <p className="text-xs md:text-sm font-bold text-slate-800">Digital Solutions Developed by Dave Maher</p>
                              </div>
                          </div>
                      </footer>
                    </div>
                ) : (
                    <OrganogramView data={data} />
                )}

                {/* Modal (Mobile Friendly - List Mode Only) */}
                {isAddingNew && editingId === "NEW" && viewMode === 'list' && (
                   <div className="fixed inset-0 bg-slate-900/40 backdrop-blur-sm z-50 flex items-center justify-center p-4">
                     <div className="bg-white rounded-2xl shadow-2xl p-6 w-full max-w-md border-t-4 border-[#006858] animate-fadeIn">
                        <div className="flex justify-between items-start mb-6">
                           <h3 className="text-xl font-black text-slate-800">Add Entry</h3>
                           <button onClick={() => setIsAddingNew(false)} className="p-2 bg-slate-100 rounded-full"><X size={18}/></button>
                        </div>
                        <div className="space-y-4">
                           <div>
                            <label className="block text-xs font-bold text-slate-500 uppercase mb-1">Category</label>
                            <select value={tempFormData.category} onChange={(e) => handleInputChange('category', e.target.value)} className="w-full p-3 bg-slate-50 border border-slate-200 rounded-xl text-sm">
                                {CATEGORIES.map(c => <option key={c} value={c}>{c}</option>)}
                            </select>
                           </div>
                           <div>
                             <label className="block text-xs font-bold text-slate-500 uppercase mb-1">Name</label>
                             <div className="relative">
                                 <input 
                                   type="text" 
                                   value={tempFormData.name} 
                                   onChange={(e) => handleInputChange('name', e.target.value)} 
                                   className="w-full p-3 pr-10 border border-slate-200 rounded-xl text-sm" 
                                   placeholder="Name" 
                                 />
                                 {tempFormData.name && (
                                   <button 
                                     onClick={() => handleInputChange('name', "")}
                                     className="absolute right-3 top-1/2 -translate-y-1/2 text-slate-400 hover:text-slate-600 bg-slate-100 rounded-full p-0.5"
                                   >
                                     <X size={14} />
                                   </button>
                                 )}
                             </div>
                           </div>
                           <button onClick={handleSave} className="w-full bg-[#006858] text-white py-3 rounded-xl font-bold mt-4">Save Entry</button>
                        </div>
                     </div>
                   </div>
                )}
              </main>
            </div>
          );
        }

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>
